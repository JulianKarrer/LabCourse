
\begin{figure}
  \centering
  \begin{subfigure}[t]{\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{groupplot}[
          group style={
              group size=2 by 3,
              vertical sep=2cm,
              horizontal sep=2cm,
            },
          colormap name=Spectral_r,
          % colormap/viridis, 
          point meta min=-1.9,
          point meta max=2.1,
          view={0}{90},
          xlabel={$k$},
          ylabel={$\lambda$},
          zlabel={$\epsilon$},
          width=0.45\textwidth,
          height=0.45\textwidth,
        ]
        \nextgroupplot[
          title={\texttt{EOSSPH}}
        ]

        \addplot3 [
          contour filled,
        ] table {500.0 0.1 -1.775406581727304
500.0 0.325 -1.774586966838677
500.0 0.55 -1.774586966838677
500.0 0.775 -1.774586966838677
500.0 1.0 -1.774586966838677

750.0 0.1 -1.0878262651867756
750.0 0.325 -1.5754976317756555
750.0 0.55 -1.5754976317756555
750.0 0.775 -1.5754976317756555
750.0 1.0 -1.5754976317756555

1000.0 0.1 0.264343272412918
1000.0 0.325 1.1789164093276245
1000.0 0.55 1.5611023545911076
1000.0 0.775 1.347344268713195
1000.0 1.0 1.6559787819070602

1250.0 0.1 0.3461347056438925
1250.0 0.325 1.2782060111110884
1250.0 0.55 1.6633369289893745
1250.0 0.775 1.4517300660877828
1250.0 1.0 1.9622149802043296

1500.0 0.1 0.3989528205702097
1500.0 0.325 1.3463315307193444
1500.0 0.55 1.7450584697134934
1500.0 0.775 1.5413034002108208
1500.0 1.0 2.070669817702054

};

        \addplot3 [
          contour gnuplot={
              contour dir=z,
              levels={-2,-1.5,-1,-0.5,0,0.5,1,1.5,2},
              labels over line,
              draw color = black,
            },
          thick,
        ] table {500.0 0.1 -1.775406581727304
500.0 0.325 -1.774586966838677
500.0 0.55 -1.774586966838677
500.0 0.775 -1.774586966838677
500.0 1.0 -1.774586966838677

750.0 0.1 -1.0878262651867756
750.0 0.325 -1.5754976317756555
750.0 0.55 -1.5754976317756555
750.0 0.775 -1.5754976317756555
750.0 1.0 -1.5754976317756555

1000.0 0.1 0.264343272412918
1000.0 0.325 1.1789164093276245
1000.0 0.55 1.5611023545911076
1000.0 0.775 1.347344268713195
1000.0 1.0 1.6559787819070602

1250.0 0.1 0.3461347056438925
1250.0 0.325 1.2782060111110884
1250.0 0.55 1.6633369289893745
1250.0 0.775 1.4517300660877828
1250.0 1.0 1.9622149802043296

1500.0 0.1 0.3989528205702097
1500.0 0.325 1.3463315307193444
1500.0 0.55 1.7450584697134934
1500.0 0.775 1.5413034002108208
1500.0 1.0 2.070669817702054

};
        \nextgroupplot[
          title={\texttt{EOSSPH}},
          view={60}{30},
          x dir=reverse,
          zmin=-1.9,
          zmax=2.1,
          % zlabel={\Epsilon},
        ]
        \addplot3 [
          surf,
          faceted color=black,
        ] table {500.0 0.1 -1.775406581727304
500.0 0.325 -1.774586966838677
500.0 0.55 -1.774586966838677
500.0 0.775 -1.774586966838677
500.0 1.0 -1.774586966838677

750.0 0.1 -1.0878262651867756
750.0 0.325 -1.5754976317756555
750.0 0.55 -1.5754976317756555
750.0 0.775 -1.5754976317756555
750.0 1.0 -1.5754976317756555

1000.0 0.1 0.264343272412918
1000.0 0.325 1.1789164093276245
1000.0 0.55 1.5611023545911076
1000.0 0.775 1.347344268713195
1000.0 1.0 1.6559787819070602

1250.0 0.1 0.3461347056438925
1250.0 0.325 1.2782060111110884
1250.0 0.55 1.6633369289893745
1250.0 0.775 1.4517300660877828
1250.0 1.0 1.9622149802043296

1500.0 0.1 0.3989528205702097
1500.0 0.325 1.3463315307193444
1500.0 0.55 1.7450584697134934
1500.0 0.775 1.5413034002108208
1500.0 1.0 2.070669817702054

};

				% -----------------------------------------------------------------------------------------------
      
        \nextgroupplot[
          title={\texttt{SplitSPH}}
        ]
        \addplot3 [
          contour filled,
        ] table {500.0 0.1 -1.8767772764572803
500.0 0.325 -1.8767772764572803
500.0 0.55 -1.8767772764572803
500.0 0.775 -1.8767772764572805
500.0 1.0 -1.8767772764572805

750.0 0.1 -0.3789489823565821
750.0 0.325 -0.34902458912763246
750.0 0.55 -0.34902458912763246
750.0 0.775 -0.34902458912763246
750.0 1.0 -0.34902458912763246

1000.0 0.1 -0.031326103139639266
1000.0 0.325 0.7029563610938275
1000.0 0.55 1.0375172646519517
1000.0 0.775 1.2558846092107683
1000.0 1.0 1.3978417037016113

1250.0 0.1 0.08853083786483268
1250.0 0.325 0.8935064048810112
1250.0 0.55 1.2264769730234093
1250.0 0.775 1.4545908600522692
1250.0 1.0 1.678435080159394

1500.0 0.1 0.16427613556411932
1500.0 0.325 0.9709248573056103
1500.0 0.55 1.3311304420778043
1500.0 0.775 1.5986730017099273
1500.0 1.0 1.8574607923137691

};
        \addplot3 [
          contour gnuplot={
              contour dir=z,
              levels={-2,-1.5,-1,-0.5,0,0.5,1,1.5,2},
              labels over line,
              draw color = black,
            },
          thick,
        ] table {500.0 0.1 -1.8767772764572803
500.0 0.325 -1.8767772764572803
500.0 0.55 -1.8767772764572803
500.0 0.775 -1.8767772764572805
500.0 1.0 -1.8767772764572805

750.0 0.1 -0.3789489823565821
750.0 0.325 -0.34902458912763246
750.0 0.55 -0.34902458912763246
750.0 0.775 -0.34902458912763246
750.0 1.0 -0.34902458912763246

1000.0 0.1 -0.031326103139639266
1000.0 0.325 0.7029563610938275
1000.0 0.55 1.0375172646519517
1000.0 0.775 1.2558846092107683
1000.0 1.0 1.3978417037016113

1250.0 0.1 0.08853083786483268
1250.0 0.325 0.8935064048810112
1250.0 0.55 1.2264769730234093
1250.0 0.775 1.4545908600522692
1250.0 1.0 1.678435080159394

1500.0 0.1 0.16427613556411932
1500.0 0.325 0.9709248573056103
1500.0 0.55 1.3311304420778043
1500.0 0.775 1.5986730017099273
1500.0 1.0 1.8574607923137691

};
        \nextgroupplot[
          title={\texttt{SplitSPH}},
          view={60}{30},
          x dir=reverse,
          zmin=-1.9,
          zmax=2.1,
          % zlabel={\Epsilon},
        ]
        \addplot3 [
          surf,
          faceted color=black,
        ] table {500.0 0.1 -1.8767772764572803
500.0 0.325 -1.8767772764572803
500.0 0.55 -1.8767772764572803
500.0 0.775 -1.8767772764572805
500.0 1.0 -1.8767772764572805

750.0 0.1 -0.3789489823565821
750.0 0.325 -0.34902458912763246
750.0 0.55 -0.34902458912763246
750.0 0.775 -0.34902458912763246
750.0 1.0 -0.34902458912763246

1000.0 0.1 -0.031326103139639266
1000.0 0.325 0.7029563610938275
1000.0 0.55 1.0375172646519517
1000.0 0.775 1.2558846092107683
1000.0 1.0 1.3978417037016113

1250.0 0.1 0.08853083786483268
1250.0 0.325 0.8935064048810112
1250.0 0.55 1.2264769730234093
1250.0 0.775 1.4545908600522692
1250.0 1.0 1.678435080159394

1500.0 0.1 0.16427613556411932
1500.0 0.325 0.9709248573056103
1500.0 0.55 1.3311304420778043
1500.0 0.775 1.5986730017099273
1500.0 1.0 1.8574607923137691

};

				% -----------------------------------------------------------------------------------------------
        
        \nextgroupplot[
          title={\texttt{IterSPH}}
        ]
        \addplot3 [
          contour filled,
        ] table {500.0 0.1 -1.3109136128321328
500.0 0.325 -1.312367656925387
500.0 0.55 -1.312367656925387
500.0 0.775 -1.312367656925387
500.0 1.0 -1.312367656925387

750.0 0.1 -1.3218067085152172
750.0 0.325 -1.3418091251446016
750.0 0.55 -1.3418091251446016
750.0 0.775 -1.3418091251446016
750.0 1.0 -1.3418091251446016

1000.0 0.1 -1.795557589416037
1000.0 0.325 -1.7072450783133748
1000.0 0.55 -1.7072450783133748
1000.0 0.775 -1.7072450783133748
1000.0 1.0 -1.7072450783133748

1250.0 0.1 -1.886149451359508
1250.0 0.325 -1.5657018240198515
1250.0 0.55 -1.5657018240198515
1250.0 0.775 -1.5657018240198515
1250.0 1.0 -1.5657018240198515

1500.0 0.1 -1.280796894067701
1500.0 0.325 -1.4199502191727416
1500.0 0.55 -1.4199502191727416
1500.0 0.775 -1.4199502191727418
1500.0 1.0 -1.4199502191727418

};

        \addplot3 [
          contour gnuplot={
              contour dir=z,
              levels={-2,-1.5,-1,-0.5,0,0.5,1,1.5,2},
              labels over line,
              draw color = black,
            },
          thick,
        ] table {500.0 0.1 -1.3109136128321328
500.0 0.325 -1.312367656925387
500.0 0.55 -1.312367656925387
500.0 0.775 -1.312367656925387
500.0 1.0 -1.312367656925387

750.0 0.1 -1.3218067085152172
750.0 0.325 -1.3418091251446016
750.0 0.55 -1.3418091251446016
750.0 0.775 -1.3418091251446016
750.0 1.0 -1.3418091251446016

1000.0 0.1 -1.795557589416037
1000.0 0.325 -1.7072450783133748
1000.0 0.55 -1.7072450783133748
1000.0 0.775 -1.7072450783133748
1000.0 1.0 -1.7072450783133748

1250.0 0.1 -1.886149451359508
1250.0 0.325 -1.5657018240198515
1250.0 0.55 -1.5657018240198515
1250.0 0.775 -1.5657018240198515
1250.0 1.0 -1.5657018240198515

1500.0 0.1 -1.280796894067701
1500.0 0.325 -1.4199502191727416
1500.0 0.55 -1.4199502191727416
1500.0 0.775 -1.4199502191727418
1500.0 1.0 -1.4199502191727418

};

        \nextgroupplot[
          title={\texttt{IterSPH}},
          view={60}{30},
          x dir=reverse,
          zmin=-1.9,
          zmax=2.1,
          % zlabel={\Epsilon},
        ]
        \addplot3 [
          surf,
          faceted color=black,
        ] table {500.0 0.1 -1.3109136128321328
500.0 0.325 -1.312367656925387
500.0 0.55 -1.312367656925387
500.0 0.775 -1.312367656925387
500.0 1.0 -1.312367656925387

750.0 0.1 -1.3218067085152172
750.0 0.325 -1.3418091251446016
750.0 0.55 -1.3418091251446016
750.0 0.775 -1.3418091251446016
750.0 1.0 -1.3418091251446016

1000.0 0.1 -1.795557589416037
1000.0 0.325 -1.7072450783133748
1000.0 0.55 -1.7072450783133748
1000.0 0.775 -1.7072450783133748
1000.0 1.0 -1.7072450783133748

1250.0 0.1 -1.886149451359508
1250.0 0.325 -1.5657018240198515
1250.0 0.55 -1.5657018240198515
1250.0 0.775 -1.5657018240198515
1250.0 1.0 -1.5657018240198515

1500.0 0.1 -1.280796894067701
1500.0 0.325 -1.4199502191727416
1500.0 0.55 -1.4199502191727416
1500.0 0.775 -1.4199502191727418
1500.0 1.0 -1.4199502191727418

};
      \end{groupplot}
    \end{tikzpicture}

  \end{subfigure}
  \begin{subfigure}[t]{\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
          hide axis,
          scale only axis,
          height=0pt,
          width=0pt,
          colormap name=Spectral_r,
          colorbar horizontal,
          point meta min=-1.9,
          point meta max=2.1,
          colorbar style={
              width=0.5\textwidth,
            }]
        \addplot [draw=none] coordinates {(0,0)};
      \end{axis}
    \end{tikzpicture}

  \end{subfigure}
  \caption{The error $\epsilon$ (\autoref{eq:action-log-error}) in the kinetic energy of the resting water column is plotted for different parameters of time step size $\lambda\in[0,1]$ and stiffness $k\in[500,1500]$ for $5\times 5$ datapoints. Each row shows one solver, where the left column are contour plots and the right column shows the same values in 3D for better visual clarity. The mapping from values to colours is shown in the bar at the bottom.}
  \label{fig:stability-k-lambda}
\end{figure}
