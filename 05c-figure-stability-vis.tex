
\begin{figure}[hb]
  \centering
  \begin{subfigure}[t]{\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{groupplot}[
          group style={
              group size=2 by 1,
              vertical sep=2cm,
              horizontal sep=2cm,
            },
          colormap name=Spectral_r,
          % colormap/viridis, 
          point meta min=-1.9,
          point meta max=2.1,
          view={0}{90},
          xlabel={$k$},
          ylabel={$\nu$},
          zlabel={$\epsilon$},
          width=0.45\textwidth,
          height=0.45\textwidth,
        ]
        \nextgroupplot[
          title={\texttt{EOSSPH}}
        ]

        \addplot3 [
          contour filled,
        ] table {500.0 0.0001 -1.775406581727304
500.0 0.000575 -2.32132244869146
500.0 0.00105 -2.72838334712473
500.0 0.001525 -2.2153678376274346
500.0 0.002 -2.353160080473529

750.0 0.0001 -1.0878262651867756
750.0 0.000575 -2.47644702914891
750.0 0.00105 -2.815872847958961
750.0 0.001525 -2.1609065301458084
750.0 0.002 -2.187307968996441

1000.0 0.0001 0.264343272412918
1000.0 0.000575 -2.3625359371724493
1000.0 0.00105 -2.216981147177807
1000.0 0.001525 -2.2962975386348528
1000.0 0.002 -2.469890546086413

1250.0 0.0001 0.3461347056438925
1250.0 0.000575 -0.08891009169294693
1250.0 0.00105 -2.7797606338486998
1250.0 0.001525 -2.527561905744824
1250.0 0.002 -2.426099096775281

1500.0 0.0001 0.3989528205702097
1500.0 0.000575 0.1323516710959186
1500.0 0.00105 0.013973700343225141
1500.0 0.001525 -0.013803633754411246
1500.0 0.002 -0.08659161795614237

};

        \addplot3 [
          contour gnuplot={
              contour dir=z,
              levels={-2,-1.5,-1,-0.5,0,0.5,1,1.5,2},
              labels over line,
              draw color = black,
            },
          thick,
        ] table {500.0 0.0001 -1.775406581727304
500.0 0.000575 -2.32132244869146
500.0 0.00105 -2.72838334712473
500.0 0.001525 -2.2153678376274346
500.0 0.002 -2.353160080473529

750.0 0.0001 -1.0878262651867756
750.0 0.000575 -2.47644702914891
750.0 0.00105 -2.815872847958961
750.0 0.001525 -2.1609065301458084
750.0 0.002 -2.187307968996441

1000.0 0.0001 0.264343272412918
1000.0 0.000575 -2.3625359371724493
1000.0 0.00105 -2.216981147177807
1000.0 0.001525 -2.2962975386348528
1000.0 0.002 -2.469890546086413

1250.0 0.0001 0.3461347056438925
1250.0 0.000575 -0.08891009169294693
1250.0 0.00105 -2.7797606338486998
1250.0 0.001525 -2.527561905744824
1250.0 0.002 -2.426099096775281

1500.0 0.0001 0.3989528205702097
1500.0 0.000575 0.1323516710959186
1500.0 0.00105 0.013973700343225141
1500.0 0.001525 -0.013803633754411246
1500.0 0.002 -0.08659161795614237

};

				% -----------------------------------------------------------------------------------------------
      
        \nextgroupplot[
          title={\texttt{SplitSPH}}
        ]
        \addplot3 [
          contour filled,
        ] table {500.0 0.0001 -1.8767772764572803
500.0 0.000575 -2.3416484055223985
500.0 0.00105 -2.5639797994737044
500.0 0.001525 -2.1294955716798696
500.0 0.002 -2.4178874158520314

750.0 0.0001 -0.3789489823565821
750.0 0.000575 -0.38952183595799644
750.0 0.00105 -0.43842090302420045
750.0 0.001525 -0.6347736181966993
750.0 0.002 -0.7508543560061871

1000.0 0.0001 -0.031326103139639266
1000.0 0.000575 -0.07242829559226019
1000.0 0.00105 -0.11023873875331318
1000.0 0.001525 -0.12104401573951722
1000.0 0.002 -0.14704307953599297

1250.0 0.0001 0.08853083786483268
1250.0 0.000575 0.0598088358013705
1250.0 0.00105 0.032324896958478365
1250.0 0.001525 -0.0011433828547922202
1250.0 0.002 -0.011763766196926767

1500.0 0.0001 0.16427613556411932
1500.0 0.000575 0.12395010079299895
1500.0 0.00105 0.10754724916022108
1500.0 0.001525 0.07121548036732889
1500.0 0.002 0.05102281432300632

};
        \addplot3 [
          contour gnuplot={
              contour dir=z,
              levels={-2,-1.5,-1,-0.5,0,0.5,1,1.5,2},
              labels over line,
              draw color = black,
            },
          thick,
        ] table {500.0 0.0001 -1.8767772764572803
500.0 0.000575 -2.3416484055223985
500.0 0.00105 -2.5639797994737044
500.0 0.001525 -2.1294955716798696
500.0 0.002 -2.4178874158520314

750.0 0.0001 -0.3789489823565821
750.0 0.000575 -0.38952183595799644
750.0 0.00105 -0.43842090302420045
750.0 0.001525 -0.6347736181966993
750.0 0.002 -0.7508543560061871

1000.0 0.0001 -0.031326103139639266
1000.0 0.000575 -0.07242829559226019
1000.0 0.00105 -0.11023873875331318
1000.0 0.001525 -0.12104401573951722
1000.0 0.002 -0.14704307953599297

1250.0 0.0001 0.08853083786483268
1250.0 0.000575 0.0598088358013705
1250.0 0.00105 0.032324896958478365
1250.0 0.001525 -0.0011433828547922202
1250.0 0.002 -0.011763766196926767

1500.0 0.0001 0.16427613556411932
1500.0 0.000575 0.12395010079299895
1500.0 0.00105 0.10754724916022108
1500.0 0.001525 0.07121548036732889
1500.0 0.002 0.05102281432300632

};
      \end{groupplot}
    \end{tikzpicture}

  \end{subfigure}
  \begin{subfigure}[t]{\textwidth}
    \centering
    \begin{tikzpicture}
      \begin{axis}[
          hide axis,
          scale only axis,
          height=0pt,
          width=0pt,
          colormap name=Spectral_r,
          colorbar horizontal,
          point meta min=-1.9,
          point meta max=2.1,
          colorbar style={
              width=0.5\textwidth,
            }]
        \addplot [draw=none] coordinates {(0,0)};
      \end{axis}
    \end{tikzpicture}

  \end{subfigure}
  \caption{The error $\epsilon$ (\autoref{eq:action-log-error}) is plotted for different parameters of time step size $\lambda\in[0,1]$ and viscosity $\nu\in[10^{-3}, 2\cdot10^{-2}]$ for $5\times 5$ datapoints. The mapping from values to colours is shown in the bar at the bottom.}
  \label{fig:stability-k-nu}
\end{figure}
